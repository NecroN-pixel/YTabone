<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Necron Analytics | v1.0.0 Global</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --accent: #ff0033;
            --bg: #030303;
            --glass: rgba(10, 10, 10, 0.85);
            --card-w: 550px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg);
            color: #fff;
            font-family: 'Plus Jakarta Sans', sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        /* --- Arka Plan: Ultra Deep --- */
        .nebula {
            position: absolute;
            width: 100%; height: 100%;
            background: radial-gradient(circle at 10% 10%, rgba(255, 0, 51, 0.08) 0%, transparent 40%),
                        radial-gradient(circle at 90% 90%, rgba(0, 123, 255, 0.08) 0%, transparent 40%);
            z-index: -1;
        }

        .floating-geometry {
            position: absolute;
            border: 1px solid rgba(255,255,255,0.05);
            background: rgba(255,255,255,0.01);
            animation: rotateFloat 30s infinite linear;
            z-index: -1;
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
        }

        @keyframes rotateFloat {
            0% { transform: translate(-10vw, -10vh) rotate(0deg); }
            100% { transform: translate(110vw, 110vh) rotate(360deg); }
        }

        /* --- Panel --- */
        .panel {
            background: var(--glass);
            backdrop-filter: blur(60px) saturate(210%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 40px;
            padding: 50px;
            width: var(--card-w);
            text-align: center;
            box-shadow: 0 100px 200px rgba(0,0,0,0.9);
            transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
        }

        /* --- MOD: FSABONE --- */
        body.fsabone .panel {
            width: 100vw; height: 100vh;
            background: transparent; border: none; box-shadow: none;
            display: flex; align-items: center; justify-content: flex-start;
            padding-left: 8%; text-align: left;
        }
        body.fsabone .fsabone-layout { display: flex; align-items: center; gap: 50px; }
        body.fsabone .hide-fs { display: none !important; }
        body.fsabone #avatar { width: 240px; height: 240px; margin: 0; box-shadow: 0 0 100px rgba(255,0,51,0.3); }
        body.fsabone .count-text { font-size: 9rem !important; margin: 0; background: #fff; -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        body.fsabone #cName { font-size: 3.5rem; margin-bottom: 10px; }

        /* --- Arama --- */
        .search-wrapper { position: relative; margin-bottom: 40px; }
        .input-global {
            width: 100%; background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 20px 25px; border-radius: 20px; color: #fff;
            font-size: 1.1rem; transition: 0.4s;
        }
        .input-global:focus { border-color: var(--accent); background: rgba(255,0,51,0.08); box-shadow: 0 0 30px rgba(255,0,51,0.2); }

        .results-tray {
            position: absolute; top: 115%; width: 100%; background: #0a0a0a;
            border-radius: 20px; border: 1px solid #222; max-height: 0;
            overflow: hidden; transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1); z-index: 1000;
        }
        .results-tray.open { max-height: 400px; padding: 10px 0; }
        .res-card {
            display: flex; align-items: center; padding: 15px 20px; cursor: pointer;
            transition: 0.2s; border-bottom: 1px solid #111;
        }
        .res-card:hover { background: #1a1a1a; }
        .res-card img { width: 45px; height: 45px; border-radius: 50%; margin-right: 15px; border: 2px solid var(--accent); }

        /* --- Profil & Sayaç --- */
        #avatar {
            width: 140px; height: 140px; border-radius: 50%;
            border: 5px solid var(--accent); margin-bottom: 25px;
            object-fit: cover; transition: 0.6s;
            display: none; /* İlk başta gizli */
        }

        .count-text {
            font-size: 5.5rem; font-weight: 800; letter-spacing: -4px;
            background: linear-gradient(180deg, #fff 30%, #555 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }

        .grid-data { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        .data-pill { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.05); }
        .data-val { font-size: 1.5rem; font-weight: 700; display: block; color: var(--accent); }
        .data-lab { font-size: 0.7rem; color: #666; letter-spacing: 2px; text-transform: uppercase; }

        .action-btn {
            background: #111; border: 1px solid #222; color: #fff;
            padding: 15px 25px; border-radius: 18px; cursor: pointer; transition: 0.3s;
            font-weight: 600; font-size: 0.9rem;
        }
        .action-btn:hover { background: #fff; color: #000; transform: translateY(-3px); }

    </style>
</head>
<body>

    <div class="nebula"></div>
    <div id="geo-layer"></div>

    <div class="panel">
        <div class="search-wrapper hide-fs">
            <input type="text" id="globalSearch" class="input-global" placeholder="Kanal ara (Enter)..." onkeyup="if(event.key==='Enter') search()">
            <div id="tray" class="results-tray"></div>
        </div>

        <div class="fsabone-layout">
            <img id="avatar" src="" alt="">
            <div class="main-info">
                <h2 id="cName">YouTube'dan Veri Çekiliyor...</h2>
                <div class="count-text" id="mainCount">0</div>
                <div class="data-lab" id="statusLabel">Canlı Takip Aktif</div>
            </div>
        </div>

        <div class="grid-data hide-fs">
            <div class="data-pill">
                <span class="data-val" id="vCount">0</span>
                <span class="data-lab">Görüntülenme</span>
            </div>
            <div class="data-pill">
                <span class="data-val" id="vidCount">0</span>
                <span class="data-lab">Video</span>
            </div>
        </div>

        <div class="footer-nav hide-fs" style="margin-top: 40px; display: flex; justify-content: center; gap: 15px;">
            <button class="action-btn" onclick="switchMode('fsabone')">Yayıncı Modu</button>
            <button class="action-btn" onclick="copySession()">Linki Kopyala</button>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyArrl6SPjBroMSzpKEsWCrLHzm3PgI1mhw';
        let tracker = null;

        // --- EN ÖNEMLİ KISIM: SAYFA AÇILDIĞINDA ÇALIŞIR ---
        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');
            const mode = urlParams.get('mode');

            if (mode === 'fsabone') document.body.classList.add('fsabone');
            
            // Eğer URL'de ID varsa hemen yükle
            if (id) {
                init(id);
            } else {
                document.getElementById('cName').innerText = "Kanal Araması Yapın";
            }
            buildGeo();
        };

        async function search() {
            const q = document.getElementById('globalSearch').value;
            if(!q) return;
            const r = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=channel&q=${encodeURIComponent(q)}&maxResults=5&key=${API_KEY}`);
            const d = await r.json();
            const t = document.getElementById('tray');
            t.innerHTML = '';
            t.classList.add('open');
            d.items.forEach(i => {
                const c = document.createElement('div');
                c.className = 'res-card';
                c.innerHTML = `<img src="${i.snippet.thumbnails.default.url}"><span>${i.snippet.title}</span>`;
                c.onclick = () => {
                    const newUrl = new URL(window.location);
                    newUrl.searchParams.set('id', i.id.channelId);
                    window.history.pushState({}, '', newUrl);
                    init(i.id.channelId);
                };
                t.appendChild(c);
            });
        }

        async function init(id) {
            document.getElementById('tray').classList.remove('open');
            try {
                const r = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=statistics,snippet&id=${id}&key=${API_KEY}`);
                const data = await r.json();
                
                if(data.items && data.items[0]) {
                    const c = data.items[0];
                    document.getElementById('cName').innerText = c.snippet.title;
                    const ava = document.getElementById('avatar');
                    ava.src = c.snippet.thumbnails.medium.url;
                    ava.style.display = 'inline-block';
                    
                    document.getElementById('mainCount').innerText = Number(c.statistics.subscriberCount).toLocaleString('tr-TR');
                    document.getElementById('vCount').innerText = Number(c.statistics.viewCount).toLocaleString('tr-TR');
                    document.getElementById('vidCount').innerText = Number(c.statistics.videoCount).toLocaleString('tr-TR');
                    
                    // Otomatik Yenileme
                    if(tracker) clearInterval(tracker);
                    tracker = setInterval(() => init(id), 10000); 
                }
            } catch (err) {
                console.error("API Hatası:", err);
            }
        }

        function switchMode(m) {
            const u = new URL(window.location);
            u.searchParams.set('mode', m);
            window.location.href = u.href;
        }

        function copySession() {
            const currentUrl = window.location.href;
            navigator.clipboard.writeText(currentUrl).then(() => {
                alert("Mükemmel! Kanal linki kopyalandı. Bu linkle her yerden istatistiklere ulaşabilirsin.");
            });
        }

        function buildGeo() {
            const l = document.getElementById('geo-layer');
            for(let i=0; i<8; i++) {
                const s = document.createElement('div');
                s.className = 'floating-geometry';
                s.style.width = Math.random()*150+50+'px';
                s.style.height = s.style.width;
                s.style.left = Math.random()*100+'vw';
                s.style.top = Math.random()*100+'vh';
                s.style.animationDuration = Math.random()*20+20+'s';
                l.appendChild(s);
            }
        }
    </script>
</body>
</html>
